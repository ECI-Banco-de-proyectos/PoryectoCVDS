<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="edu.eci.cvds.persistencia.mybatisimpl.mappers.IniciativaMapper">


	<insert id="insertIniciativa" >
		insert into iniciativa values(#{id},#{user},#{name},#{est},#{vot},#{fec},#{desc})
	</insert>
	
	<select id="selectIniciativas" resultMap='IniciativaResult'>
		select * from iniciativa
	</select>

	<select id="claveIniciativas" resultMap='IniciativaResult'>
		select * from iniciativa where nombreiniciativa like '%#{clave}%'
	</select>

	<update id="cambiarIniciativa" >
		update iniciativa set estado=#{estado}
		where id=#{id};
	</update>

	<select id="ordenDeIniciativa" resultMap='IniciativaResult'>
		select * from iniciativa i
		order by
			case when #{columnaSeleccionada}='id' then i.id end,
			case when #{columnaSeleccionada}='id del proponente' then i.usuario end,
			case when #{columnaSeleccionada}='nombre' then i.nombreiniciativa end,
			case when #{columnaSeleccionada}='estado' then i.estado end,
			case when #{columnaSeleccionada}='fecha' then i.fechainicio end;
	</select>

	<resultMap type="Iniciativa" id="IniciativaResult">
		<id column="id" property="id"/>	
		<result column="usuario" property="proponente"/>
		<result column="nombreiniciativa" property="nombre"/>
		<result column="estado" property="estado"/>
		<result column="numerovotos" property="numeroVotos"/>
		<result column="fechainicio" property="fecha"/>
		<result column="descripcion" property="descripcion"/>
		
	</resultMap>

</mapper>